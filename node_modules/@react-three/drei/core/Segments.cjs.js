"use strict";var e=require("@babel/runtime/helpers/extends"),t=require("three"),r=require("react"),n=require("@react-three/fiber"),o=require("three-stdlib");function c(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var s=c(t),i=c(r);const a=i.createContext(null),u=i.forwardRef(((t,r)=>{i.useMemo((()=>n.extend({SegmentObject:l})),[]);const{limit:c=1e3,lineWidth:u=1,children:m,...f}=t,[b,d]=i.useState([]),[h]=i.useState((()=>new o.Line2)),[g]=i.useState((()=>new o.LineMaterial)),[p]=i.useState((()=>new o.LineSegmentsGeometry)),[w]=i.useState((()=>new s.Vector2(512,512))),[S]=i.useState((()=>Array(6*c).fill(0))),[v]=i.useState((()=>Array(6*c).fill(0))),j=i.useMemo((()=>({subscribe:e=>(d((t=>[...t,e])),()=>d((t=>t.filter((t=>t.current!==e.current)))))})),[]);return n.useFrame((()=>{for(let t=0;t<c;t++){var e;const r=null==(e=b[t])?void 0:e.current;r&&(S[6*t+0]=r.start.x,S[6*t+1]=r.start.y,S[6*t+2]=r.start.z,S[6*t+3]=r.end.x,S[6*t+4]=r.end.y,S[6*t+5]=r.end.z,v[6*t+0]=r.color.r,v[6*t+1]=r.color.g,v[6*t+2]=r.color.b,v[6*t+3]=r.color.r,v[6*t+4]=r.color.g,v[6*t+5]=r.color.b)}p.setColors(v),p.setPositions(S),h.computeLineDistances()})),i.createElement("primitive",{object:h,ref:r},i.createElement("primitive",{object:p,attach:"geometry"}),i.createElement("primitive",e({object:g,attach:"material",vertexColors:!0,resolution:w,linewidth:u},f)),i.createElement(a.Provider,{value:j},m))}));class l{constructor(){this.color=new s.Color("white"),this.start=new s.Vector3(0,0,0),this.end=new s.Vector3(0,0,0)}}const m=e=>e instanceof s.Vector3?e:new s.Vector3(..."number"==typeof e?[e,e,e]:e),f=i.forwardRef((({color:e,start:t,end:r},n)=>{const o=i.useContext(a);if(!o)throw"Segment must used inside Segments component.";const c=i.useRef(null);return i.useImperativeHandle(n,(()=>c.current),[]),i.useLayoutEffect((()=>o.subscribe(c)),[]),i.createElement("segmentObject",{ref:c,color:e,start:m(t),end:m(r)})}));exports.Segment=f,exports.SegmentObject=l,exports.Segments=u;
