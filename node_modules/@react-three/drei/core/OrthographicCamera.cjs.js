"use strict";var e=require("@babel/runtime/helpers/extends"),r=require("react"),t=require("@react-three/fiber"),n=require("./Fbo.cjs.js");function u(e){var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}require("three");var a=u(r);const c=a.forwardRef((({envMap:r,resolution:u=256,frames:c=1/0,children:s,makeDefault:o,...i},l)=>{const f=t.useThree((({set:e})=>e)),h=t.useThree((({camera:e})=>e)),g=t.useThree((({size:e})=>e)),d=a.useRef(null);a.useImperativeHandle(l,(()=>d.current),[]);const m=a.useRef(null),b=n.useFBO(u);a.useLayoutEffect((()=>{i.manual||d.current.updateProjectionMatrix()}),[g,i]),a.useLayoutEffect((()=>{d.current.updateProjectionMatrix()})),a.useLayoutEffect((()=>{if(o){const e=h;return f((()=>({camera:d.current}))),()=>f((()=>({camera:e})))}}),[d,o,f]);let p=0,j=null;const v="function"==typeof s;return t.useFrame((e=>{v&&(c===1/0||p<c)&&(m.current.visible=!1,e.gl.setRenderTarget(b),j=e.scene.background,r&&(e.scene.background=r),e.gl.render(e.scene,d.current),e.scene.background=j,e.gl.setRenderTarget(null),m.current.visible=!0,p++)})),a.createElement(a.Fragment,null,a.createElement("orthographicCamera",e({left:g.width/-2,right:g.width/2,top:g.height/2,bottom:g.height/-2,ref:d},i),!v&&s),a.createElement("group",{ref:m},v&&s(b.texture)))}));exports.OrthographicCamera=c;
